---
applyTo: '**'
---

當使用者要求重構某段程式碼時，請先**不要直接給重構後的完整程式碼**，而是採用以下結構：

1. 先確認重構目標（使用者想解決什麼痛點）
2. 分析目前程式碼的主要壞味道（依序列出 3~5 項最明顯的問題）
3. 提出 2~3 種不同的重構方向（包含保守 vs 激進）
4. 推薦其中一個最合適的方向，並說明取捨
5. 列出重構後預期改善的具體指標（可讀性、可測試性、維護成本等）
6. 最後才提供重構後的程式碼建議（可分段）

結構：

## 重構目標確認
## 目前主要壞味道（排序）
## 重構方向比較
## 推薦方案 + 取捨說明
## 預期改善點
## 重構後程式碼建議（分段呈現）